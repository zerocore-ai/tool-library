{
  "manifest_version": "0.3",
  "name": "elastic",
  "version": "0.1.1",
  "description": "An MCP server for Elastic Search, Kibana, and Elastic Security",
  "license": "Apache-2.0",
  "homepage": "https://www.elastic.co",
  "documentation": "https://www.elastic.co/docs/explore-analyze/ai-features/agent-builder/mcp-server",
  "icon": "icon.png",
  "author": {
    "name": "Stephen Akinyemi"
  },
  "compatibility": {
    "platforms": ["darwin", "win32", "linux"]
  },
  "server": {
    "transport": "http",
    "mcp_config": {
      "url": "${user_config.kibana_url}/api/agent_builder/mcp",
      "headers": {
        "Authorization": "ApiKey ${user_config.api_key}"
      }
    }
  },
  "tools": [
    { "name": "platform_core_cases", "description": "Retrieves cases from Elastic Security, Observability, or Stack Management" },
    { "name": "platform_core_execute_esql", "description": "Execute an ES|QL query and return the results in a tabular format" },
    { "name": "platform_core_generate_esql", "description": "Generate an ES|QL query from a natural language query" },
    { "name": "platform_core_get_document_by_id", "description": "Retrieve the full content of an Elasticsearch document based on its ID and index name" },
    { "name": "platform_core_get_index_mapping", "description": "Retrieve mappings for the specified index or indices" },
    { "name": "platform_core_get_workflow_execution_status", "description": "Retrieve the status of a workflow execution" },
    { "name": "platform_core_index_explorer", "description": "List relevant indices, aliases and datastreams based on a natural language query" },
    { "name": "platform_core_integration_knowledge", "description": "Search and retrieve knowledge from Fleet-installed integrations" },
    { "name": "platform_core_list_indices", "description": "List the indices, aliases and datastreams from the Elasticsearch cluster" },
    { "name": "platform_core_product_documentation", "description": "Search and retrieve documentation about Elastic products" },
    { "name": "platform_core_search", "description": "Search and analyze data within your Elasticsearch cluster" },
    { "name": "security_security_labs_search", "description": "Search and analyze Security Labs content" }
  ],
  "user_config": {
    "kibana_url": {
      "type": "string",
      "title": "Kibana URL",
      "description": "Base URL for your Kibana instance (e.g. http://localhost:5601 or https://kibana.example.com).",
      "default": "http://localhost:5601",
      "required": true
    },
    "api_key": {
      "type": "string",
      "title": "Kibana API Key",
      "description": "API key value used for the Authorization header (without the 'ApiKey ' prefix).",
      "required": true,
      "sensitive": true
    }
  },
  "_meta": {
    "store.tool.mcpb": {
      "static_responses": {
        "tools/list": {
          "tools": [
            {
              "name": "platform_core_cases",
              "description": "Retrieves cases from Elastic Security, Observability, or Stack Management. Supports three operation modes:\n\n**Operation Mode 1: Get case by ID**\n- Provide 'caseId' parameter to retrieve a specific case by its ID\n- Use 'includeComments' to control whether comments are fetched (default: false)\n\n**Operation Mode 2: Find cases by alert IDs**\n- Provide 'alertIds' array to find all cases containing any of these alerts\n- Use 'includeComments' or provide 'search' text to fetch comments when relevant\n\n**Operation Mode 3: Search cases**\n- Use search and filter parameters to find cases matching criteria\n- Search parameters:\n  - 'search': Text query for searching case title/description (e.g., \"malware\", \"phishing attack\")\n  - 'searchFields': Fields to search - [\"title\"] or [\"description\"] or both (default: both)\n- Filter parameters:\n  - 'severity': Filter by severity - \"low\" | \"medium\" | \"high\" | \"critical\" (single or array)\n  - 'status': Filter by status - \"open\" | \"closed\" | \"in-progress\" (single or array)\n  - 'tags': Filter by tags - array of tag names\n  - 'assignees': Filter by assignees - array of user profile UIDs\n  - 'reporters': Filter by reporters - array of reporter usernames\n  - 'category': Filter by category - string or array\n  - 'owner': Filter by owner - \"cases\" | \"observability\" | \"securitySolution\"\n- Date range:\n  - 'start': ISO datetime string for start time (inclusive), maps to Cases API \"from\"\n  - 'end': ISO datetime string for end time (exclusive), maps to Cases API \"to\"\n- Comments:\n  - 'includeComments': Set to true when query is about case contents, details, discussions, or when search text might match comment content\n  - Defaults to false for metadata-only queries (status, severity, tags, etc.)\n  - Automatically set to true if 'search' text is provided\n\n**Examples:**\n- \"Get case abc-123\": { caseId: \"abc-123\", includeComments: false }\n- \"Find cases with alert ID xyz\": { alertIds: [\"xyz\"] }\n- \"High severity open cases\": { severity: \"high\", status: \"open\" }\n- \"Cases about malware\": { search: \"malware\", includeComments: true }\n- \"Cases with tag security from last week\": { tags: [\"security\"], start: \"2025-01-15T00:00:00Z\" }\n\nReturns case details (id, title, description, status, severity, tags, assignees, observables, alerts/comments). Each case includes 'markdown_link' field with pre-formatted clickable link: [Case Title](url).\n\n**CRITICAL**: ALWAYS include the 'markdown_link' field for each case in your response. Format: brief summary (2-3 sentences) + markdown link. Example: \"Security investigation case. Status: open. [View Case](url)\"",
              "input_schema": {
                "type": "object",
                "properties": {
                  "caseId": {
                    "type": "string",
                    "description": "Case ID to retrieve a specific case. If provided, returns only that case. Use this for getting a single case by its ID."
                  },
                  "alertIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Array of alert IDs to find cases containing these alerts. If provided, cases containing any of these alert IDs will be returned. Alert IDs must be provided via this parameter."
                  },
                  "owner": {
                    "type": "string",
                    "enum": ["cases", "observability", "securitySolution"],
                    "description": "Filter cases by owner. Valid values: \"cases\" (Stack Management/General Cases), \"observability\" (Observability), \"securitySolution\" (Elastic Security). If not provided, returns all cases the user has access to."
                  },
                  "start": {
                    "type": "string",
                    "description": "ISO datetime string for the start time to fetch cases (inclusive). Maps to Cases API \"from\" parameter. Format: \"2025-01-15T00:00:00Z\""
                  },
                  "end": {
                    "type": "string",
                    "description": "ISO datetime string for the end time to fetch cases (exclusive). Maps to Cases API \"to\" parameter. Format: \"2025-01-22T00:00:00Z\""
                  },
                  "search": {
                    "type": "string",
                    "description": "Elasticsearch simple_query_string query for searching case title and description. Use this to search for text within cases (e.g., \"malware\", \"phishing attack\")."
                  },
                  "searchFields": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": ["title", "description"]
                    },
                    "description": "Fields to perform the search query against. Valid values: \"title\", \"description\". If not provided, searches both fields by default."
                  },
                  "severity": {
                    "anyOf": [
                      { "type": "string", "enum": ["low", "medium", "high", "critical"] },
                      { "type": "array", "items": { "type": "string", "enum": ["low", "medium", "high", "critical"] } }
                    ],
                    "description": "Filter cases by severity. Valid values: \"low\", \"medium\", \"high\", \"critical\". Can be a single value or an array for multiple values."
                  },
                  "status": {
                    "anyOf": [
                      { "type": "string", "enum": ["open", "closed", "in-progress"] },
                      { "type": "array", "items": { "type": "string", "enum": ["open", "closed", "in-progress"] } }
                    ],
                    "description": "Filter cases by status. Valid values: \"open\", \"closed\", \"in-progress\". Can be a single value or an array for multiple values."
                  },
                  "tags": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Filter cases by tags. Provide an array of tag names to filter by."
                  },
                  "assignees": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Filter cases by assignees. Provide an array of user profile UIDs (not usernames)."
                  },
                  "reporters": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Filter cases by reporters. Provide an array of reporter usernames who created the cases."
                  },
                  "category": {
                    "anyOf": [
                      { "type": "string" },
                      { "type": "array", "items": { "type": "string" } }
                    ],
                    "description": "Filter cases by category. Can be a single category string or an array of categories."
                  },
                  "includeComments": {
                    "type": "boolean",
                    "default": false,
                    "description": "Whether to fetch and include case comments in the response. Set to true when the query is about case contents, details, discussions, or when search text might match comment content. Defaults to false for metadata-only queries (status, severity, tags, etc.)."
                  }
                },
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_execute_esql",
              "description": "Execute an ES|QL query and return the results in a tabular format.\n\n**IMPORTANT**: This tool only **runs** queries; it does not write them.\nThink of this as the final step after a query has been prepared.\n\nYou **must** get the query from one of two sources before calling this tool:\n1.  The output of the `platform.core.generate_esql` tool (if the tool is available).\n2.  A verbatim query provided directly by the user.\n\nUnder no circumstances should you invent, guess, or modify a query yourself for this tool.\nIf you need a query, use the `platform.core.generate_esql` tool first.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "The ES|QL query to execute"
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_generate_esql",
              "description": "Generate an ES|QL query from a natural language query.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "A natural language query to generate an ES|QL query from."
                  },
                  "index": {
                    "type": "string",
                    "description": "(optional) Index to search against. If not provided, will use the index explorer to find the best index to use."
                  },
                  "context": {
                    "type": "string",
                    "description": "(optional) Additional context that could be useful to generate the ES|QL query"
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_get_document_by_id",
              "description": "Retrieve the full content (source) of an Elasticsearch document based on its ID and index name.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "ID of the document to retrieve"
                  },
                  "index": {
                    "type": "string",
                    "description": "Name of the index to retrieve the document from"
                  }
                },
                "required": ["id", "index"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_get_index_mapping",
              "description": "Retrieve mappings for the specified index or indices.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "indices": {
                    "type": "array",
                    "items": { "type": "string" },
                    "minItems": 1,
                    "description": "List of indices to retrieve mappings for."
                  }
                },
                "required": ["indices"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_get_workflow_execution_status",
              "description": "Retrieve the status of a workflow execution.\n\nIf the workflow execution has completed, the final output will be returned. Otherwise, the execution status will be returned.\n\n**important**: do **NOT** call this tool directly after calling a workflow tool.\nInstead, if the workflow didn't complete, tell the user they can ask you to check the execution.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "executionId": {
                    "type": "string",
                    "description": "ID of the workflow execution (execution_id) to retrieve the status for."
                  }
                },
                "required": ["executionId"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_index_explorer",
              "description": "List relevant indices, aliases and datastreams based on a natural language query.\n\nThe 'indexPattern' parameter can be used to filter indices by a specific pattern, e.g. 'foo*'.\nThis should *only* be used if you know what you're doing (e.g. if the user explicitly specified a pattern).\nOtherwise, leave it empty to search against all indices.\n\n*Example:*\nUser: \"Show me my latest alerts\"\nYou: call tool 'index_explorer' with { query: 'indices containing user alerts' }\nTool result: [{ type: \"index\", name: '.alerts' }]",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "A natural language query to infer which indices, aliases or datastreams to use."
                  },
                  "limit": {
                    "type": "number",
                    "description": "(optional) Limit the max number of indices to return. Defaults to 1."
                  },
                  "indexPattern": {
                    "type": "string",
                    "description": "(optional) Index pattern to filter indices by. Defaults to *."
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_integration_knowledge",
              "description": "Search and retrieve knowledge from Fleet-installed integrations. This includes information on how to configure and use integrations for data ingestion into Elasticsearch.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "Search query to retrieve knowledge about Fleet-installed integrations, like specific integration names, configuration questions, or data ingestion topics. Rewrite the query to English and incorporate relevant context from the conversation history."
                  },
                  "max": {
                    "type": "number",
                    "default": 5,
                    "description": "Maximum number of documents to return. Defaults to 5."
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_list_indices",
              "description": "List the indices, aliases and datastreams from the Elasticsearch cluster.\n\nThe 'pattern' optional parameter is an index pattern which can be used to filter resources.\nThis parameter should only be used when you already know of a specific pattern to filter on,\ne.g. if the user provided one. Otherwise, do not try to invent or guess a pattern.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "default": "*",
                    "description": "Index pattern to match Elasticsearch indices, aliases and datastream names.\n      - Correct examples: '.logs-*', '*data*', 'metrics-prod-*', 'my-specific-index', '*'\n      - Should only be used if you are certain of a specific index pattern to filter on. *Do not try to guess*.\n      - Defaults to '*' to match all indices."
                  }
                },
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_product_documentation",
              "description": "Search and retrieve documentation about Elastic products (Kibana, Elasticsearch, Elastic Security, Elastic Observability).",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "Search query to retrieve documentation about Elastic products. Rewritten in English to best match the documentation content."
                  },
                  "product": {
                    "type": "string",
                    "enum": ["kibana", "elasticsearch", "observability", "security"],
                    "description": "Product to filter by: \"kibana\", \"elasticsearch\", \"observability\", or \"security\""
                  },
                  "max": {
                    "type": "number",
                    "default": 3,
                    "description": "Maximum number of documents to return. Defaults to 3."
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "platform_core_search",
              "description": "A powerful tool for searching and analyzing data within your Elasticsearch cluster.\nIt supports both full-text relevance searches and structured analytical queries.\n\nUse this tool for any query that involves finding documents, counting, aggregating, or summarizing data from a known index.\n\nExamples of queries:\n- \"find articles about serverless architecture\"\n- \"search for support tickets mentioning 'billing issue' or 'refund request'\"\n- \"what is our policy on parental leave?\"\n- \"list all products where the category is 'electronics'\"\n- \"show me the last 5 documents from that index\"\n- \"show me the sales over the last year break down by month\"\n\nNote:\n- The 'index' parameter can be used to specify which index to search against.\n If not provided, the tool will decide itself which is the best index to use.\n- It is perfectly fine not to specify the 'index' parameter. It should only be specified when you already\n know about the index and fields you want to search on, e.g. if the user explicitly specified it.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "A natural language query expressing the search request"
                  },
                  "index": {
                    "type": "string",
                    "description": "(optional) Index to search against. If not provided, will automatically select the best index to use based on the query."
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            },
            {
              "name": "security_security_labs_search",
              "description": "Search and analyze Security Labs content installed via the AI knowledge base artifacts. Use this tool to find Security Labs articles about specific malware, attack techniques, MITRE ATT&CK techniques, or rule names. Limits results to 3 articles.",
              "input_schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "A natural language query expressing the search request for Security Labs articles. Use this to find Security Labs content about specific malware, attack techniques, MITRE ATT&CK techniques, or rule names."
                  }
                },
                "required": ["query"],
                "additionalProperties": false
              }
            }
          ]
        }
      }
    }
  }
}
